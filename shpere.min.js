
[WARNING] Try to use a single 'var' statement per scope.
].update();}for( ---> var  <--- j=0;j<balls.length;

[WARNING] Try to use a single 'var' statement per scope.
sphereVelocity.x=0;}for( ---> var  <--- i=balls.length-1;i>=

[WARNING] The variable i has already been declared in the same scope...
.x=0;}for(var  ---> i <--- =balls.length-1;i>=0

[WARNING] Try to use a single 'var' statement per scope.
paddle.draw();}for( ---> var  <--- j=0;j<balls.length;

[WARNING] Try to use a single 'var' statement per scope.
drawLongitudes(){var frontColor="rgba(255,255,255,0.8)"; ---> var  <--- rearColor="rgba(190,190,190,0.6)";ctx.lineWidth=2.5;

[WARNING] Try to use a single 'var' statement per scope.
;ctx.lineWidth=2.5;for( ---> var  <--- j=0;j<sphere.length;

[WARNING] Try to use a single 'var' statement per scope.
++){ctx.beginPath(); ---> var  <--- pt0=sphereToRect(r,sphere[j]

[WARNING] Try to use a single 'var' statement per scope.
(pt0.y));for( ---> var  <--- i=1;i<sphere[j]

[WARNING] Try to use a single 'var' statement per scope.
j].length;i++){ ---> var  <--- pt=sphereToRect(r,sphere[j]

[WARNING] Try to use a single 'var' statement per scope.
{var sphere=[];for( ---> var  <--- t=0;t<30;t++

[WARNING] Try to use a single 'var' statement per scope.
.push([]);for( ---> var  <--- p=0;p<30;p++

[WARNING] Try to use a single 'var' statement per scope.
;starBoxSize=cvs.width;for( ---> var  <--- i=0;i<500;i++

[WARNING] Try to use a single 'var' statement per scope.
y*y+z*z); ---> var  <--- S=Math.sqrt(z*z+

[WARNING] Try to use a single 'var' statement per scope.
z*z+x*x); ---> var  <--- theta=-z>=0?Math.asin

[WARNING] Try to use a single 'var' statement per scope.
==0){theta=0;} ---> var  <--- phi=Math.acos(-y/rho

[WARNING] Try to use a single 'var' statement per scope.
y:y,z:z}; ---> var  <--- pt1={x:0,y:0

[WARNING] Try to use a single 'var' statement per scope.
,phi){var xprime=x; ---> var  <--- yprime=y*Math.cos(phi)

[WARNING] Try to use a single 'var' statement per scope.
z*Math.sin(phi); ---> var  <--- zprime=y*Math.sin(phi)

[WARNING] Try to use a single 'var' statement per scope.
rho>r-this.tolerance){ ---> var  <--- spherePos=rectToSphere(this.pos.x,

[WARNING] Try to use a single 'var' statement per scope.
.cos(spherePos.theta)); ---> var  <--- paddleTheta=Math.acos(Math.cos(

[WARNING] Try to use a single 'var' statement per scope.
)){this.hasBounced=true; ---> var  <--- N=sphereToRect(r,paddle.vertex.

[WARNING] Try to use a single 'var' statement per scope.
theta,paddle.vertex.phi); ---> var  <--- normalFactor=Math.sqrt(N.x*

[WARNING] Try to use a single 'var' statement per scope.
this.pos.z,sphere_tau); ---> var  <--- radius_temp=rectToStereoRect(this.trueRadius,this.

[WARNING] Try to use a single 'var' statement per scope.
trueRadius,pt.z*3); ---> var  <--- radius=radius_temp.x;ctx.beginPath(

[WARNING] Try to use a single 'var' statement per scope.
;i<number;i++){ ---> var  <--- newColor="rgb("+Math.floor(randomRange(

[WARNING] Try to use a single 'var' statement per scope.
-0.03,0.03)))); ---> var  <--- tb=balls[balls.length-1]

[WARNING] Try to use a single 'var' statement per scope.
switchCounter){switchCounter=0;for( ---> var  <--- i=0;i<balls.length-

[WARNING] Try to use a single 'var' statement per scope.
>balls[i+1]){ ---> var  <--- temp=balls[i];balls[i

[WARNING] Try to use a single 'var' statement per scope.
);var center=this.vertex; ---> var  <--- ptv=sphereToRect(r,this.vertex.

[WARNING] Try to use a single 'var' statement per scope.
y,ptv.z,sphere_tau); ---> var  <--- pt0=sphereToRect(r,this.vertex.

[WARNING] Try to use a single 'var' statement per scope.
y,pt0.z,sphere_tau); ---> var  <--- pt1=sphereToRect(r,this.vertex.

[WARNING] Try to use a single 'var' statement per scope.
y,pt1.z,sphere_tau); ---> var  <--- pt2=sphereToRect(r,this.vertex.

[WARNING] Try to use a single 'var' statement per scope.
y,pt2.z,sphere_tau); ---> var  <--- pt3=sphereToRect(r,this.vertex.

[WARNING] Try to use a single 'var' statement per scope.
){var x=ev.x; ---> var  <--- y=ev.y;if(ev.

[WARNING] Try to use a single 'var' statement per scope.
N.z*N.z); ---> var  <--- scalar=-2*(N.x*

[WARNING] Try to use a single 'var' statement per scope.
z*V0.z/normalFactor); ---> var  <--- Vnew={x:scalar*N.x

[WARNING] The symbol center is declared but is apparently never used.
This code can probably be written in a more compact way.
){ctx.beginPath();var  ---> center <--- =this.vertex;var ptv=sphereToRect(
function init(){cvs=document.getElementById("canvas13k");ctx=cvs.getContext("2d");cvs.height=window.innerHeight;cvs.width=window.innerWidth;cvs.addEventListener("mousedown",onMouseDown,false);cvs.addEventListener("mousemove",onMouseMove,false);cvs.addEventListener("mouseup",onMouseUp,false);cvs.addEventListener("touchstart",onMouseDown,false);cvs.addEventListener("touchmove",onMouseMove,false);cvs.addEventListener("touchend",onMouseUp,false);isMouseDown=false;mouseSensitivity=100;currentMouseCoords={x:0,y:0};sphereVelocity={x:0,y:0};sphereDecel=10;r=cvs.height<=cvs.width?cvs.height/2:cvs.width/2;r-=10;delta={theta:0,phi:0};sphere_tau=-Math.PI/6;starBoxSize=0;score=0;tm={current:Date.now(),last:null,step:function(){this.last=this.current;this.current=Date.now()},delta:function(){return this.current-this.last}};sphere=makesphere();paddle=new Paddle("rgba(20,160,80,0.9)","rgba(20,160,80,0.4)",sphere[15][15]);stars=makestars();balls=[new Ball("green",0,0,0,0,0,-0.15)]}function shpereMain(){init();setInterval(loop,33)}function loop(){clear();update();draw()}function clear(){ctx.clearRect(0,0,cvs.width,cvs.height);var a=cvs.width;cvs.width=1;cvs.width=a}function update(){tm.step();paddle.update();for(var b=0;b<stars.length;b++){stars[b].update()}for(var a=0;a<balls.length;a++){balls[a].update()}if(!isMouseDown){delta.theta+=sphereVelocity.x}sphereVelocity.x=sphereVelocity.x*0.95;if(Math.abs(sphereVelocity.x)<0.005){sphereVelocity.x=0}for(var b=balls.length-1;b>=0;b--){if(balls[b].deleteMe==true){delete balls[b];balls.splice(b,1)}}}function draw(){ctx.translate(cvs.width/2,cvs.height/2);for(var b=0;b<stars.length;b++){stars[b].draw()}if(!paddle.isInFront){paddle.draw()}for(var a=0;a<balls.length;a++){balls[a].draw()}drawLongitudes();if(paddle.isInFront){paddle.draw()}}function drawLongitudes(){var b="rgba(255,255,255,0.8)";var f="rgba(190,190,190,0.6)";ctx.lineWidth=2.5;for(var a=0;a<sphere.length;a++){ctx.beginPath();var e=sphereToRect(r,sphere[a][0].theta+delta.theta,sphere[a][0].phi);e=rotateAboutY(e.x,e.y,e.z,sphere_tau);ctx.moveTo(Math.round(e.x),Math.round(e.y));for(var c=1;c<sphere[a].length;c++){var d=sphereToRect(r,sphere[a][c].theta+delta.theta,sphere[a][c].phi);d=rotateAboutY(d.x,d.y,d.z,sphere_tau);ctx.lineTo(Math.round(d.x),Math.round(d.y));if(c==15){ctx.strokeStyle=d.z>0?b:f}}ctx.stroke()}}function makesphere(){var a=[];for(var b=0;b<30;b++){a.push([]);for(var c=0;c<30;c++){a[b].push({theta:b*12/360*Math.PI*2,phi:c*6/360*Math.PI*2})}}return a}function makestars(){var b=[];starBoxSize=cvs.width;for(var a=0;a<500;a++){b.push(new Star("white",randomRange(-starBoxSize,starBoxSize),randomRange(-starBoxSize,starBoxSize),randomRange(-starBoxSize,starBoxSize)))}return b}function rectToSphere(a,g,f){var b=Math.sqrt(a*a+g*g+f*f);var d=Math.sqrt(f*f+a*a);var c=-f>=0?Math.asin(a/d):Math.PI-Math.asin(a/d);if(d==0){c=0}var e=Math.acos(-g/b);return{rho:b,theta:c,phi:e}}function sphereToRect(a,b,c){x=a*Math.sin(c)*Math.cos(b);y=a*Math.sin(c)*Math.sin(b);z=a*Math.cos(c);return{x:y,y:-z,z:-x}}function sphereToStereoRect(a,b,c){var d=sphereToRect(a,b,c);return rectToStereoRect(d.x,d.y,d.z)}function rectToStereoRect(a,e,d){var b={x:a,y:e,z:d};var c={x:0,y:0,z:0};c.x=b.x*(-3*r)/(b.z+-3*r+-3*r);c.y=b.y*(-3*r)/(b.z+-3*r+-3*r);c.z=b.z;return c}function rotateAboutY(a,g,f,d){var e=a;var c=g*Math.cos(d)-f*Math.sin(d);var b=g*Math.sin(d)+f*Math.cos(d);return{x:e,y:c,z:b}}function rotateAboutAxisInXZPlane(){}function Star(b,a,d,c){this.pos={x:a,y:d,z:c};this.vel={x:0,y:0,z:0.1};this.color=b;this.radius=1;this.update=function(){this.pos.x+=this.vel.x*tm.delta();this.pos.y+=this.vel.y*tm.delta();this.pos.z+=this.vel.z*tm.delta();if(this.pos.z>starBoxSize){this.pos.z=-starBoxSize}};this.draw=function(){ctx.beginPath();var e={x:0,y:0,z:0};e=rectToStereoRect(this.pos.x,this.pos.y,this.pos.z);ctx.arc(e.x,e.y,this.radius,0,2*Math.PI,false);ctx.fillStyle=this.color;ctx.closePath();ctx.fill()}}function Ball(e,b,g,f,d,c,a){this.trueRadius=25;deleteMe=false;this.color=e;this.pos={x:b,y:g,z:f};this.vel={x:d,y:c,z:a};this.tolerance=10;this.insideSphere=true;this.hasBounced=false;this.bounceTimerCounter=0;this.update=function(){this.vel.y=0;this.pos.y=0;var j=Math.sqrt(this.pos.x*this.pos.x+this.pos.y*this.pos.y+this.pos.z*this.pos.z);if(j>r+r/2){this.kill()}else{if(j<r+this.tolerance&&j>r-this.tolerance){var l=rectToSphere(this.pos.x,this.pos.y,this.pos.z);l.theta=l.theta%(2*Math.PI);l.theta=Math.acos(Math.cos(l.theta));var i=Math.acos(Math.cos(paddle.vertex.theta+delta.theta));if(l.theta<0){l.theta+=Math.PI*2}if(!this.hasBounced&&l.theta<(i+paddle.deg/2)%(Math.PI*2)&&l.theta>(i-paddle.deg/2)%(Math.PI*2)){this.hasBounced=true;var k=sphereToRect(r,paddle.vertex.theta+delta.theta,paddle.vertex.phi);var h=Math.sqrt(k.x*k.x+k.y*k.y+k.z*k.z);k.x=k.x/h;k.y=0;k.z=k.z/h;this.vel=reflect(k,this.vel);score+=13;if(score%39==0){this.multiball(2,k)}}if(j>r){this.insideSphere=false}}}this.pos.x+=this.vel.x*tm.delta();this.pos.z+=this.vel.z*tm.delta();if(this.hasBounced){this.bounceTimerCounter++;if(this.bounceTimerCounter>10){this.bounceTimerCounter=0;this.hasBounced=false}}};this.draw=function(){var j=rotateAboutY(this.pos.x,this.pos.y,this.pos.z,sphere_tau);var i=rectToStereoRect(this.trueRadius,this.trueRadius,j.z*3);var h=i.x;ctx.beginPath();ctx.arc(j.x,j.y,h,0,2*Math.PI,false);ctx.fillStyle=this.color;ctx.closePath();ctx.fill();ctx.strokeStyle="black";ctx.stroke();if(this.insideSphere){}};this.kill=function(){this.deleteMe=true};this.explode=function(){this.deleteMe=true};this.checkCollision=function(){};this.multiball=function(l,m){for(var k=0;k<l;k++){var j="rgb("+Math.floor(randomRange(120,190))+","+Math.floor(randomRange(120,190))+","+Math.floor(randomRange(120,190))+")";balls.push(new Ball(j,0,0,0,-m.x*(0.15+randomRange(-0.03,0.03)),0,-m.z*(0.15+randomRange(-0.03,0.03))));var h=balls[balls.length-1];h.pos.x+=h.vel.x*tm.delta();h.pos.z+=h.vel.z*tm.delta()}}}function sortBalls(){var c=1;while(c){c=0;for(var b=0;b<balls.length-1;b++){if(balls[b]>balls[b+1]){var a=balls[b];balls[b]=balls[b+1];balls[b+1]=a;c++}}}}function Paddle(a,c,b){this.vertex=b;this.frontColor=a;this.rearColor=c;this.deg=0.5084;isInFront=true;this.update=function(){var d=sphereToRect(r,this.vertex.theta+delta.theta,this.vertex.phi);d=rotateAboutY(d.x,d.y,d.z,sphere_tau);this.isInFront=d.z>0?true:false};this.draw=function(){ctx.beginPath();var d=this.vertex;var e=sphereToRect(r,this.vertex.theta+delta.theta,this.vertex.phi);e=rotateAboutY(e.x,e.y,e.z,sphere_tau);var i=sphereToRect(r,this.vertex.theta-this.deg/2+delta.theta,this.vertex.phi-this.deg/2);i=rotateAboutY(i.x,i.y,i.z,sphere_tau);var h=sphereToRect(r,this.vertex.theta+this.deg/2+delta.theta,this.vertex.phi-this.deg/2);h=rotateAboutY(h.x,h.y,h.z,sphere_tau);var g=sphereToRect(r,this.vertex.theta+this.deg/2+delta.theta,this.vertex.phi+this.deg/2);g=rotateAboutY(g.x,g.y,g.z,sphere_tau);var f=sphereToRect(r,this.vertex.theta-this.deg/2+delta.theta,this.vertex.phi+this.deg/2);f=rotateAboutY(f.x,f.y,f.z,sphere_tau);ctx.moveTo(Math.round(i.x),Math.round(i.y));ctx.lineTo(Math.round(h.x),Math.round(h.y));ctx.lineTo(Math.round(g.x),Math.round(g.y));ctx.lineTo(Math.round(f.x),Math.round(f.y));ctx.fillStyle=this.isInFront?this.frontColor:this.rearColor;ctx.fill()}}function onMouseDown(a){a.preventDefault();isMouseDown=true;currentMouseCoords=getMouseCoords(a)}function onMouseUp(a){a.preventDefault();isMouseDown=false;sphereVelocity.x=-(currentMouseCoords.x-lastMouseCoords.x)/mouseSensitivity;sphereVelocity.y=-(currentMouseCoords.y-lastMouseCoords.y)/mouseSensitivity}function onMouseMove(a){a.preventDefault();lastMouseCoords=currentMouseCoords;currentMouseCoords=getMouseCoords(a);if(isMouseDown){delta.theta+=-(currentMouseCoords.x-lastMouseCoords.x)/mouseSensitivity}}function getMouseCoords(b){var a=b.x;var c=b.y;if(b.x||b.x==0){a=b.x;c=b.y;a-=cvs.offsetLeft;c-=cvs.offsetTop}else{if(b.layerX||b.layerX==0){a=b.layerX;c=b.layerY}else{if(b.offsetX||b.offsetX==0){a=b.offsetX;c=b.offsetY}else{if(b.pageX||b.pageX==0){a=b.pageX;c=b.pageY;if(!b.changedTouches){c-=cvs.offsetTop;a-=cvs.offsetLeft}}else{a=0;c=0}}}}return{x:a,y:c}}function randomRange(d,c){return Math.random()*((d<c)?(c-d):(d-c))+((d<c)?d:c)}function reflect(e,d){var b=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);var c=-2*(e.x*d.x/b+e.y*d.y/b+e.z*d.z/b);var a={x:c*e.x/b+d.x,y:c*e.y/b+d.y,z:c*e.z/b+d.z};return a};